'!TITLE "Denso robot program"

#Include "..\CGNX_API.pcs"

'
'Get Speed
'
Function CGNX_GS(ByVal recvCmd As Variant) As String
	CGNX_GS = Sprintf("GS,%d", FAILED)
	If checkInputData(recvCmd(0), "GS") = FAILED Then Exit Function

	On Error GoTo ErrorHandler
		'Get current external speed
		CGNX_GS = Sprintf("%s,%d,%f", recvCmd(0), SUCCEEDED, CurExtSpd)
	Exit Function

	ErrorHandler:
		PrintMsg Now & "- " & err.OriginalNumber &": " & err.Description
End Function
